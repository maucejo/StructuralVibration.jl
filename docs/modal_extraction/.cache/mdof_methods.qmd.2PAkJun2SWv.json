{
    "cells": [
        {
            "id": "1",
            "cell_type": "markdown",
            "metadata": {
            },
            "source": [
                "---\n",
                "title: Mdof methods\n",
                "format:\n",
                "  html:\n",
                "    toc: true\n",
                "    number-sections: true\n",
                "engine: julia\n",
                "execute:\n",
                "  freeze: auto\n",
                "  cache: true\n",
                "---\n",
                "\n",
                "The Mdof methods are based on the assumption that the system can be represented as a multiple degree of freedom system. They are generally based on the construction of a high-order polynomial matrix whose coefficients are estimated from the measured FRFs. As for the SDOF methods, the estimation of the modal parameters is divided into two steps:\n",
                "\n",
                "1. estimation of the poles of the system to extract the natural frequencies and modal damping ratios,\n",
                "2. estimation of the residues to extract the mode shapes.\n",
                "\n",
                "\n",
                "## Natural frequencies and damping ratios extraction\n",
                "The poles of the system are then obtained as the roots of the characteristic polynomial associated with this polynomial matrix. Three methods are implemented in this package:\n",
                "\n",
                "<!-- * the Least-Squares Complex Exponential (LSCE) method, -->\n",
                "* the Least-Squares Complex Frequency-domain (LSCF) method.\n",
                "* the Polyreference Least-Squares Complex Frequency-domain (pLSCF) method,\n",
                "\n",
                "\n",
                "<!-- ### LSCE method\n",
                "\n",
                "The LSCE method is based on the assumption that the system can be modeled as a sum of complex exponentials in the time domain. The impulse response function (IRF) between an output $o$ ($o = 1, \\ldots, n_o$) and an input $i$ ($i = 1, \\ldots, n_i$) can be modeled as:\n",
                "$$\n",
                "h_{oi}(t) = \\sum_{k = 1}^n \\left(c_k e^{\\lambda_k t} + c_k^\\ast e^{-\\lambda_k^\\ast t}\\right) = \\sum_{k = 1}^{2n} c_k e^{\\lambda_k t}.\n",
                "$$\n",
                "\n",
                "When sampling the IRF at a sampling period $T_s$, one obtains the following discrete-time model:\n",
                "$$\n",
                "h_{oi}[m] = \\sum_{k = 1}^{2n} c_k z_k^m \\text{ with } z_k = e^{\\lambda_k T_s},\n",
                "$$\n",
                "for $m = 0, 1, \\ldots, 2n$, ($n$ is the model order). According to the Prony's method, the poles $\\lambda_k$ can be calculated from the roots of the following characteristic polynomial:\n",
                "$$\n",
                "\\sum_{m = 0}^{2n} \\beta_m z_k^m = 0 \\text{ with } \\beta_{2n} = 1.\n",
                "$$\n",
                "\n",
                "The coefficients $\\beta_l$ of the characteristic polynomial can be estimated from the sampled IRF $h_{oi}[m]$. Todo so, one first multiply $h_{oi}[m]$ by the corresponding coefficients $\\beta_m$ and then sums the resulting equations for $m = 0, 1, \\ldots, 2n$. This leads to the following homogeneous set of equations:\n",
                "$$\n",
                "\\sum_{m = 0}^{2n} \\beta_m h_{oi}[m] = \\sum_{k = 1}^{2n} c_k \\left(\\sum_{m = 0}^{2n} \\beta_m z_k^m\\right).\n",
                "$$\n",
                "\n",
                "When $z_k$ is a root of the characteristic polynomial, the right-hand side of the previous equation is equal to zero. Therefore, one can estimate the coefficients $\\beta_m$ by solving the following set of linear equations:\n",
                "$$\n",
                "\\sum_{m = 0}^{2n} \\beta_m h_{oi}[m] = 0.\n",
                "$$\n",
                "\n",
                "The previous equation can be derived using different set of data points, $h_{oi}[m]$, $h_{oi}[m+1]$, $\\ldots$, $h_{oi}[m + 2n]$  to obtain an overdetermined set of linear equations that can be solved in the least-squares sense[^1]. In this package, the coefficients $\\beta_m$ are estimated by solving the following set of equations:\n",
                "$$\n",
                "\\begin{bmatrix}\n",
                "h_{oi}[0] & h_{oi}[1] & \\ldots & h_{oi}[2n-1] \\\\\n",
                "h_{oi}[1] & h_{oi}[2] & \\ldots & h_{oi}[2n] \\\\\n",
                "\\vdots & \\vdots & \\ddots & \\vdots \\\\\n",
                "h_{oi}[2n-1] & h_{oi}[2n] & \\ldots & h_{oi}[4n-2]\n",
                "\\end{bmatrix}\n",
                "\\begin{bmatrix}\n",
                "\\beta_0 \\\\\n",
                "\\beta_1 \\\\\n",
                "\\vdots \\\\\n",
                "\\beta_{2n-1}\n",
                "\\end{bmatrix}\n",
                "= -\\begin{bmatrix}\n",
                "h_{oi}[2n] \\\\\n",
                "h_{oi}[2n+1] \\\\\n",
                "\\vdots \\\\\n",
                "h_{oi}[4n-1]\n",
                "\\end{bmatrix}\n",
                "$$\n",
                "\n",
                "Once the coefficients $\\beta_m$ are estimated, the poles $\\lambda_k$ can be obtained from the roots $z_k$ of the characteristic polynomial.\n",
                "\n",
                "[^1]: D. Brown, R. Allemang and R. Zimmerman and M. Mergeay. \"Parameter estimation techniques for modal analysis\". SAE Technical Paper 790221, 1979. -->\n",
                "\n",
                "### LSCF method\n",
                "\n",
                "According to Guillaume et al. [^2], the transfer function between an output $o$ ($o = 1, \\ldots, n_o$)  and an input $i$ ($i = 1, \\ldots, n_i$) can be modeled in the frequency domain as:\n",
                "$$\n",
                "\\widehat{H}_k(\\omega) = \\frac{N_k(\\omega)}{d(\\omega)},\n",
                "$$\n",
                "where $k = 1, \\ldots, n_o n_i$ ($k = (o - 1) n_i + i$). Here, $N_k(\\omega)$ is the $k$-th element of the numerator matrix defined as:\n",
                "$$\n",
                "N_k(\\omega) = \\mathbf{\\Omega}(\\omega)^T \\boldsymbol{\\beta}_k,\n",
                "$$\n",
                "while $d(\\omega)$ is the common denominator polynomial defined as:\n",
                "$$\n",
                "d(\\omega) = \\mathbf{\\Omega}(\\omega)^T \\boldsymbol{\\alpha}.\n",
                "$$\n",
                "\n",
                "In the previous equations, $\\mathbf{\\Omega}(\\omega)$ is the vector of polynomial basis functions defined as:\n",
                "$$\n",
                "\\mathbf{\\Omega}(\\omega)^T = [1, \\Omega_1(\\omega), \\ldots, \\Omega_n(\\omega)] \\text{ with } \\Omega_n(\\omega) = \\exp(-i\\omega n T_s),\n",
                "$$\n",
                "where $n$ is the order of the denominator polynomial (a.k.a the model order) and $T_s$ is the sampling period. The vectors $\\boldsymbol{\\beta}_k$ and $\\boldsymbol{\\alpha}$ contain the coefficients of the numerator and denominator polynomials, respectively.\n",
                "\n",
                "Based on the previous formulation of the FRFs, the LSCF method consists in estimating the coefficients of the numerator $\\boldsymbol{\\beta}_k$ and denominator $\\boldsymbol{\\alpha}$ polynomials by minimizing the following functional:\n",
                "$$\n",
                "J(\\boldsymbol{\\theta}) = \\sum_{k=1}^{n_o n_i} \\sum_{j=1}^{n_f} \\left| W_k(\\omega_j)\\left[H_k(\\omega_j) d(\\omega_j) - N_k(\\omega_j)\\right] \\right|^2,\n",
                "$$\n",
                "where $\\boldsymbol{\\theta} = [\\boldsymbol{\\beta}_1^T, \\ldots, \\boldsymbol{\\beta}_{n_o n_i}^T, \\boldsymbol{\\alpha}^T]^T$ is the vector of unknown parameters to be estimated, $H_k(\\omega_j)$ is the measured FRF at frequency $\\omega_j$, $n_f$ is the number of frequency lines used for the identification and $W_k(\\omega_j)$ is an arbitrary weighting function. In this package, a unitary weighting function is used, i.e. $W_k(\\omega_j) = 1$.\n",
                "\n",
                "The poles of the transfer function are obtained from the roots of the characteristic polynomial associated with the denominator polynomial $d(\\omega)$, which are computed after having estimated the coefficients $\\boldsymbol{\\alpha}$ as the argument of the minimum of the functional $J(\\boldsymbol{\\theta})$ (see Ref. [2] for details).\n",
                "\n",
                "[^2]: P. Guillaume, P. Verboven, S. Vanlanduit, H. Van der Auweraer and B. Peeters, \"A poly-reference implementation of the least-squares complex frequency-domain estimator\". Proceedings of the 21st International Modal Analysis Conference, IMAC, 2003.\n",
                "\n",
                "### pLSCF method\n",
                "\n",
                "The pLSCF method is an extension of the LSCF method that makes it possible to take into account multiple reference sensors simultaneously (see Ref. [2] for details). When using only one reference sensor, the pLSCF method is equivalent to the LSCF method.\n",
                "\n",
                "In this approach, the transfer function $\\widehat{\\mathbf{H}}_o(\\omega) \\in \\mathbb{C}^{1 \\times n_i}$ between an output $o$ ($o = 1, \\ldots, n_o$) and a set of $n_i$ inputs can be modeled in the frequency domain as:\n",
                "$$\n",
                "\\widehat{\\mathbf{H}}_o(\\omega) = \\mathbf{N}_o(\\omega) \\mathbf{D}(\\omega)^{-1},\n",
                "$$\n",
                "where $\\mathbf{N}_o(\\omega) \\in \\mathbb{C}^{1 \\times n_i}$ is the numerator matrix defined as:\n",
                "$$\n",
                "\\mathbf{N}_o(\\omega) = \\mathbf{\\Omega}(\\omega)^T \\boldsymbol{\\beta}_o,\n",
                "$$\n",
                "while $\\mathbf{D}(\\omega) \\in \\mathbb{C}^{n_i \\times n_i}$ is the denominator matrix defined as:\n",
                "$$\n",
                "\\mathbf{D}(\\omega) = \\mathbf{\\Omega}(\\omega)^T \\boldsymbol{\\alpha}.\n",
                "$$\n",
                "\n",
                "Based on the previous formulation of the FRFs, the pLSCF method consists in estimating the coefficients of the numerator $\\boldsymbol{\\beta}_o$ and denominator $\\boldsymbol{\\alpha}$ polynomials. To this end, one defines the weighted error between the measured and modeled FRFs as:\n",
                "$$\n",
                "\\boldsymbol{\\varepsilon}_o(\\omega_j, \\boldsymbol{\\theta}) = W_o(\\omega_j)\\left[\\mathbf{H}_o(\\omega_j) \\mathbf{D}(\\omega_j) - \\mathbf{N}_o(\\omega_j)\\right]\n",
                "$$\n",
                "\n",
                "Then, an error matrix $\\mathbf{E}_o(\\boldsymbol{\\theta}) \\in \\mathbb{C}^{n_f \\times n_i}$ is constructed by stacking the weighted errors $\\boldsymbol{\\varepsilon}_o(\\omega_j, \\boldsymbol{\\theta}) \\in \\mathbb{C}^{1 \\times n_i}$ for all frequency lines, that is:\n",
                "$$\n",
                "\\mathbf{E}_o(\\boldsymbol{\\theta}) = \\begin{bmatrix}\n",
                "\\boldsymbol{\\varepsilon}_o(\\omega_1, \\boldsymbol{\\theta}) \\\\\n",
                "\\vdots \\\\\n",
                "\\boldsymbol{\\varepsilon}_o(\\omega_{n_f}, \\boldsymbol{\\theta})\n",
                "\\end{bmatrix}\n",
                "$$\n",
                "\n",
                "Finally, the coefficients of the numerator and denominator polynomials are estimated by minimizing the following functional:\n",
                "$$\n",
                "J(\\boldsymbol{\\theta}) = \\sum_{o=1}^{n_o} \\Vert\\mathbf{E}_o(\\boldsymbol{\\theta})\\Vert^2.\n",
                "$$\n",
                "\n",
                "The poles of the transfer function are obtained from the characteristic polynomial associated with the denominator matrix $\\mathbf{D}(\\omega)$, by computing the eigenvalues of the so-called companion matrix[^3].\n",
                "\n",
                "[^3]: M. El-Kafafy, P. Guillaume, B. Peeters, F. Marra, G. Coppotelli. \"Advanced Frequency-Domain Modal Analysis for Dealing with Measurement Noise and Parameter Uncertainty\". In: Allemang R., De Clerck J., Niezrecki C., Blough J. (eds) Topics in Modal Analysis I, Volume 5. Conference Proceedings of the Society for Experimental Mechanics Series. 2012."
            ]
        }
    ],
    "timestamp": "2025-10-09T17:33:21.738",
    "file": "/Users/maucejo/Documents/01_Recherche/04_Projets/Codes/Julia/StructuralVibration/docs/modal_extraction/mdof_methods.qmd",
    "qnr_schema_version": "1.0.0"
}