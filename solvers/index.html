<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Sdof solvers â€“ StructuralVibration.jl</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../solvers/modal_time_solvers.html" rel="next">
<link href="../assets/logo/doclogo.svg" rel="icon" type="image/svg+xml">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-4d04b275c36bd460889107e331013233.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-585a77d67552b4a34eb0de6c9603dd02.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>



<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../assets/logo/doclogo.svg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">StructuralVibration.jl</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Overview</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../models/index.html"> 
<span class="menu-text">Models</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../solvers/index.html" aria-current="page"> 
<span class="menu-text">Solvers</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../modal_extraction/index.html"> 
<span class="menu-text">Modal extraction</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../signal_processing/index.html"> 
<span class="menu-text">Signal processing</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../visualization/index.html"> 
<span class="menu-text">Visualization</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/maucejo/StructuralVibration.jl"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../solvers/index.html">Sdof solvers</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../solvers/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Sdof solvers</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../solvers/modal_time_solvers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modal time solvers</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../solvers/direct_time_solvers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Direct-time integration solvers</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../solvers/state_space_solvers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">State-space solvers</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../solvers/frequency_solvers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Frequency-domain solvers</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#time-domain-solvers" id="toc-time-domain-solvers" class="nav-link active" data-scroll-target="#time-domain-solvers"><span class="header-section-number">1</span> Time domain solvers</a>
  <ul class="collapse">
  <li><a href="#free-response" id="toc-free-response" class="nav-link" data-scroll-target="#free-response"><span class="header-section-number">1.1</span> Free response</a></li>
  <li><a href="#forced-response" id="toc-forced-response" class="nav-link" data-scroll-target="#forced-response"><span class="header-section-number">1.2</span> Forced response</a></li>
  <li><a href="#additional-functions" id="toc-additional-functions" class="nav-link" data-scroll-target="#additional-functions"><span class="header-section-number">1.3</span> Additional functions</a></li>
  </ul></li>
  <li><a href="#frequency-domain-solvers" id="toc-frequency-domain-solvers" class="nav-link" data-scroll-target="#frequency-domain-solvers"><span class="header-section-number">2</span> Frequency domain solvers</a>
  <ul class="collapse">
  <li><a href="#frequency-response-function" id="toc-frequency-response-function" class="nav-link" data-scroll-target="#frequency-response-function"><span class="header-section-number">2.1</span> Frequency Response Function</a></li>
  <li><a href="#response-spectrum" id="toc-response-spectrum" class="nav-link" data-scroll-target="#response-spectrum"><span class="header-section-number">2.2</span> Response spectrum</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Sdof solvers</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="time-domain-solvers" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="time-domain-solvers"><span class="header-section-number">1</span> Time domain solvers</h2>
<p>The package provides a set of solvers to compute the time response of a single-degree-of-freedom (sdof) system.</p>
<section id="free-response" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="free-response"><span class="header-section-number">1.1</span> Free response</h3>
<p>The free response of a sdof system is the response of the system when it is subjected to initial conditions only. This means that the displacement of the mass is solution of the following ordinary differential equation: <span class="math display">\[
\begin{cases}
  \ddot x(t) + 2 \xi\omega_0\dot x(t) + \omega_0^2 x(t) = 0 \\
  x(0) = x_0 \\
  \dot x(0) = v_0
\end{cases}.
\]</span></p>
<p>Depending on the value of the damping ratio <span class="math inline">\(\xi\)</span> and <span class="math inline">\(\omega_0 &gt; 0\)</span>, the system can have 4 different types of free response:</p>
<ul>
<li><p>an undamped motion when <span class="math inline">\(\xi = 0\)</span>. In this case, the free response is: <span class="math display">\[
x(t) = x_0\cos\omega_0 t + \frac{v_0}{\omega_0}\sin\omega_0 t
\]</span></p></li>
<li><p>an underdamped motion when <span class="math inline">\(0 &lt; \xi &lt; 1\)</span>. In this case, the free response is: <span class="math display">\[
x(t) = \left[x_0\cos\Omega_0 t + \frac{v_0 + \xi\Omega_0 x_0}{\Omega_0}\sin\Omega_0 t\right]e^{-\xi\omega_0 t}
\]</span> where <span class="math inline">\(\Omega_0 = \omega_0\sqrt{1 - \xi^2}\)</span>.</p></li>
<li><p>a critically damped motion when <span class="math inline">\(\xi = 1\)</span>. In this case, the free response is: <span class="math display">\[
x(t) = \left[x_0 + (v_0 + \omega_0 x_0)t\right]e^{-\omega_0 t}
\]</span></p></li>
<li><p>an overdamped motion when <span class="math inline">\(\xi &gt; 1\)</span>. In this case, the free response is: <span class="math display">\[
x(t) = \left[x_0\text{cosh}(\beta t) + \frac{v_0 + \xi\omega_0 x_0}{\beta}\text{sinh}\beta t\right]e^{-\xi\omega_0 t},
\]</span> where <span class="math inline">\(\beta = \omega_0\sqrt{\xi^2 - 1}\)</span>.</p></li>
</ul>
<p>Finally, if <span class="math inline">\(\omega = 0\)</span>, the mass is free from constraints and the free response is: <span class="math display">\[
x(t) = x_0 + v_0 t.
\]</span></p>
<section id="api" class="level4" data-number="1.1.1">
<h4 data-number="1.1.1" class="anchored" data-anchor-id="api"><span class="header-section-number">1.1.1</span> API</h4>
<p><strong>Data type</strong></p>
<div class="api">
<p><strong>SdofFreeTimeProblem</strong></p>
<hr>
<div id="4" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display" data-execution_count="1">
<div class="markdown"><pre><code>SdofFreeTimeProblem(sdof, u0, t)</code></pre>
<p>Structure containing the data of a time problem for a sdof system</p>
<p><strong>Fields</strong></p>
<ul>
<li><p><code>sdof::Sdof</code>: Sdof structure</p>
</li>
<li><p><code>u0::AbstractVector</code>: Initial conditions</p>
<ul>
<li><p><code>x0</code>: Initial displacement [m]</p>
</li>
<li><p><code>v0</code>: Initial velocity [m/s]</p>
</li>
</ul>
</li>
<li><p><code>t::AbstractRange</code>: Time points at which to evaluate the response</p>
</li>
</ul>


</div>
</div>
</div>
</div>
<p><strong>Related function</strong></p>
<div class="api">
<p><strong>solve</strong></p>
<hr>
<div id="6" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display" data-execution_count="1">
<div class="markdown"><pre><code>solve(prob::SdofFreeTimeProblem)</code></pre>
<p>Compute the free response of a single degree of freedom (Sdof) system.</p>
<p><strong>Input</strong></p>
<ul>
<li><p><code>prob</code>: Structure containing the parameters of the Sdof problem</p>
</li>
</ul>
<p><strong>Output</strong></p>
<ul>
<li><p><code>sol</code>: The response of the system at the given time points</p>
<ul>
<li><p><code>u</code>: Displacement solution</p>
</li>
<li><p><code>du</code>: Velocity solution</p>
</li>
<li><p><code>ddu</code>: Acceleration solution</p>
</li>
</ul>
</li>
</ul>


</div>
</div>
</div>
</div>
</section>
<section id="example" class="level4" data-number="1.1.2">
<h4 data-number="1.1.2" class="anchored" data-anchor-id="example"><span class="header-section-number">1.1.2</span> Example</h4>
<div id="8" class="cell" data-ouput="false" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Structural parameters</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="fl">1</span>.</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>f0 <span class="op">=</span> <span class="fl">1</span>.</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Time vector</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> <span class="fl">0</span>.<span class="op">:</span><span class="fl">0.01</span><span class="op">:</span><span class="fl">10</span>.</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial conditions</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>u0 <span class="op">=</span> [<span class="fl">1</span>., <span class="op">-</span><span class="fl">2</span>.]</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Undamped system</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>sdof_nd <span class="op">=</span> <span class="fu">Sdof</span>(m, f0, <span class="fl">0</span>.)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>prob_nd <span class="op">=</span> <span class="fu">SdofFreeTimeProblem</span>(sdof_nd, u0, t)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>x_nd <span class="op">=</span> <span class="fu">solve</span>(prob_nd).u</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Underdamped system</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>sdof_ud <span class="op">=</span> <span class="fu">Sdof</span>(m, f0, <span class="fl">0.1</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>prob_ud <span class="op">=</span> <span class="fu">SdofFreeTimeProblem</span>(sdof_ud, u0, t)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>x_ud <span class="op">=</span> <span class="fu">solve</span>(prob_ud).u</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Critically damped system</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>sdof_cd <span class="op">=</span> <span class="fu">Sdof</span>(m, f0, <span class="fl">1</span>.)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>prob_cd <span class="op">=</span> <span class="fu">SdofFreeTimeProblem</span>(sdof_cd, u0, t)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>x_cd <span class="op">=</span> <span class="fu">solve</span>(prob_cd).u</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Overdamped system</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>sdof_od <span class="op">=</span> <span class="fu">Sdof</span>(m, f0, <span class="fl">1.2</span>)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>prob_od <span class="op">=</span> <span class="fu">SdofFreeTimeProblem</span>(sdof_od, u0, t)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>x_od <span class="op">=</span> <span class="fu">solve</span>(prob_od).u;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="10" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-6-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="forced-response" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="forced-response"><span class="header-section-number">1.2</span> Forced response</h3>
<p>The forced response of a sdof system is the response of the system is the solution of the following ordinary differential equation: <span class="math display">\[
\begin{cases}
  \ddot x(t) + 2 \xi\omega_0\dot x(t) + \omega_0^2 x(t) = \displaystyle\frac{\text{rhs}(t)}{m} \\
  x(0) = x_0 \\
  \dot x(0) = v_0
\end{cases},
\]</span> where <span class="math inline">\(\text{rhs}(t)\)</span> is the right-hand side of the equation and its expression depends on the type of excitation: <span class="math display">\[
\text{rhs}(t) = \begin{cases}
f(t) &amp; \text{for an external force excitation} \\
m\omega_0^2 x_b(t) + 2\xi\omega_0m\dot x_b(t) &amp; \text{for a base excitation}
\end{cases}.
\]</span></p>
<p>Finally, the solution of the forced response is expressed as the sum of two terms, since: <span class="math display">\[
x(t) = x_h(t) + x_p(t),
\]</span> where <span class="math inline">\(x_h(t)\)</span> is the homogeneous solution of the equation and <span class="math inline">\(x_p(t)\)</span> is the particular solution of the equation.</p>
<section id="harmonic-excitation" class="level4" data-number="1.2.1">
<h4 data-number="1.2.1" class="anchored" data-anchor-id="harmonic-excitation"><span class="header-section-number">1.2.1</span> Harmonic excitation</h4>
<p>When the excitation is harmonic, the resolution process is the following:</p>
<ol type="1">
<li><p>Compute the particular solution of the equation. The particular solution is a harmonic function of the same frequency as the excitation.</p></li>
<li><p>Express the general solution of the homogeneous equation.</p></li>
<li><p>Compute the remaining constants using the initial conditions. These constants depends on <span class="math inline">\(x_p(0)\)</span> and <span class="math inline">\(\dot x_p(0)\)</span>.</p></li>
</ol>
<section id="api-1" class="level5" data-number="1.2.1.1">
<h5 data-number="1.2.1.1" class="anchored" data-anchor-id="api-1"><span class="header-section-number">1.2.1.1</span> API</h5>
<p><strong>Data type</strong></p>
<div class="api">
<p><strong>SdofHarmonicTimeProblem</strong></p>
<hr>
<div id="12" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display" data-execution_count="1">
<div class="markdown"><pre><code>SdofHarmonicTimeProblem(sdof, u0, t, F, Ï‰, type_exc)</code></pre>
<p>Structure containing the data of a time problem for a sdof system subject to a harmonic excitation</p>
<p><strong>Constructor parameters</strong></p>
<ul>
<li><p><code>sdof::Sdof</code>: Sdof structure</p>
</li>
<li><p><code>F</code>: Amplitude of the force excitation [N] or base motion [m]</p>
</li>
<li><p><code>f</code>: Frequency of the excitation [Hz]</p>
</li>
<li><p><code>u0::AbstractVector</code>: Initial conditions</p>
<ul>
<li><p><code>x0</code>: Initial displacement [m]</p>
</li>
<li><p><code>v0</code>: Initial velocity [m/s]</p>
</li>
</ul>
</li>
<li><p><code>t::AbstractRange</code>: Time points at which to evaluate the response</p>
</li>
<li><p><code>type_exc::Symbol</code>: Type of excitation</p>
<ul>
<li><p><code>:force</code>: External force (default)</p>
</li>
<li><p><code>:base</code>: Base motion</p>
</li>
</ul>
</li>
</ul>
<p><strong>Fields</strong></p>
<ul>
<li><p><code>sdof::Sdof</code>: Sdof structure</p>
</li>
<li><p><code>F</code>: Amplitude of the force excitation [N] or base motion [m]</p>
</li>
<li><p><code>Ï‰</code>: Frequency of the excitation [rad/s]</p>
</li>
<li><p><code>u0::AbstractVector</code>: Initial conditions</p>
<ul>
<li><p><code>x0</code>: Initial displacement [m]</p>
</li>
<li><p><code>v0</code>: Initial velocity [m/s]</p>
</li>
</ul>
</li>
<li><p><code>t::AbstractRange</code>: Time points at which to evaluate the response</p>
</li>
<li><p><code>type_exc::Symbol</code>: Type of excitation</p>
<ul>
<li><p><code>:force</code>: External force (default)</p>
</li>
<li><p><code>:base</code>: Base motion</p>
</li>
</ul>
</li>
</ul>


</div>
</div>
</div>
</div>
<p><strong>Related function</strong></p>
<div class="api">
<p><strong>solve</strong></p>
<hr>
<div id="14" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display" data-execution_count="1">
<div class="markdown"><pre><code>solve(prob::SdofHarmonicTimeProblem)</code></pre>
<p>Computes the forced response of a single degree of freedom (Sdof) system due to an harmonic external force or base motion</p>
<p><strong>Inputs</strong></p>
<ul>
<li><p><code>prob</code>: Structure containing the parameters of the Sdof harmonic problem</p>
</li>
</ul>
<p><strong>Output</strong></p>
<ul>
<li><p><code>sol</code>: The response of the system at the given time points</p>
<ul>
<li><p><code>u</code>: Displacement solution</p>
</li>
<li><p><code>du</code>: Velocity solution</p>
</li>
<li><p><code>ddu</code>: Acceleration solution</p>
</li>
</ul>
</li>
</ul>


</div>
</div>
</div>
</div>
</section>
<section id="example-1" class="level5" data-number="1.2.1.2">
<h5 data-number="1.2.1.2" class="anchored" data-anchor-id="example-1"><span class="header-section-number">1.2.1.2</span> Example</h5>
<div id="16" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Structural parameters</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="fl">1</span>.</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>f0 <span class="op">=</span> <span class="fl">1</span>.</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>Î¾ <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiation of the Sdof object</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>sdof <span class="op">=</span> <span class="fu">Sdof</span>(m, f0, Î¾)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Harmonic excitation - Force amplitude + excitation frequency</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>F0 <span class="op">=</span> <span class="fl">10</span>.</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="fl">2</span>.</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiation of the problem</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> <span class="fl">0</span>.<span class="op">:</span><span class="fl">0.01</span><span class="op">:</span><span class="fl">10</span>.</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>u0 <span class="op">=</span> [<span class="fl">1</span>., <span class="op">-</span><span class="fl">2</span>.]</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>prob <span class="op">=</span> <span class="fu">SdofHarmonicTimeProblem</span>(sdof, F0, f, u0, t, <span class="op">:</span>force)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Solve the problem</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>x_harmo <span class="op">=</span> <span class="fu">solve</span>(prob).u</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="18" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-10-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="arbitrary-excitation" class="level4" data-number="1.2.2">
<h4 data-number="1.2.2" class="anchored" data-anchor-id="arbitrary-excitation"><span class="header-section-number">1.2.2</span> Arbitrary excitation</h4>
<p>For an arbitrary excitation, the solution is given by: <span class="math display">\[
x(t) = x_\text{free}(t) + \int_0^t rhs(t - Ï„)h(Ï„)dÏ„,
\]</span> where <span class="math inline">\(x_\text{free}(t)\)</span> is the free response of the system and <span class="math inline">\(h(t)\)</span> is the impulse response of the system.</p>
<section id="api-2" class="level5" data-number="1.2.2.1">
<h5 data-number="1.2.2.1" class="anchored" data-anchor-id="api-2"><span class="header-section-number">1.2.2.1</span> API</h5>
<p><strong>Data type</strong></p>
<div class="api">
<p><strong>SdofForcedTimeProblem</strong></p>
<hr>
<div id="20" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display" data-execution_count="1">
<div class="markdown"><pre><code>SdofForcedTimeProblem(sdof, u0, t, F, Ï‰, type_exc)</code></pre>
<p>Structure containing the data of a time problem for a sdof system subject to an arbitrary excitation</p>
<p><strong>Fields</strong></p>
<ul>
<li><p><code>sdof::Sdof</code>: Sdof structure</p>
</li>
<li><p><code>F::AbstractVector</code>: Amplitude of the force excitation [N] or base motion [m]</p>
</li>
<li><p><code>u0::AbstractVector</code>: Initial conditions</p>
<ul>
<li><p><code>x0</code>: Initial displacement [m]</p>
</li>
<li><p><code>v0</code>: Initial velocity [m/s]</p>
</li>
</ul>
</li>
<li><p><code>t::AbstractRange</code>: Time points at which to evaluate the response</p>
</li>
<li><p><code>type_exc::Symbol</code>: Type of excitation</p>
<ul>
<li><p><code>:force</code>: External force (default)</p>
</li>
<li><p><code>:base</code>: Base motion</p>
</li>
</ul>
</li>
</ul>


</div>
</div>
</div>
</div>
<p><strong>Related function</strong></p>
<div class="api">
<p><strong>solve</strong></p>
<hr>
<div id="22" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display" data-execution_count="1">
<div class="markdown"><pre><code>solve(prob::SdofForcedTimeProblem)</code></pre>
<p>Computes the forced response of a single degree of freedom (Sdof) system due to an arbitrary external force or base motion</p>
<p><strong>Inputs</strong></p>
<ul>
<li><p><code>prob</code>: Structure containing the parameters of the Sdof forced problem</p>
</li>
<li><p><code>method</code>: Method to compute the Duhamel's integral</p>
<ul>
<li><p><code>:filt</code>: Filtering using the Z-transform of the impulse response (default)</p>
</li>
<li><p><code>:interp</code>: Interpolation + Gaussian quadrature</p>
</li>
<li><p><code>:conv</code>: Convolution product</p>
</li>
</ul>
</li>
</ul>
<p><strong>Output</strong></p>
<ul>
<li><p><code>sol</code>: The response of the system at the given time points</p>
<ul>
<li><p><code>u</code>: Displacement solution</p>
</li>
<li><p><code>du</code>: Velocity solution</p>
</li>
<li><p><code>ddu</code>: Acceleration solution</p>
</li>
</ul>
</li>
</ul>


</div>
</div>
</div>
</div>
</section>
<section id="example-2" class="level5" data-number="1.2.2.2">
<h5 data-number="1.2.2.2" class="anchored" data-anchor-id="example-2"><span class="header-section-number">1.2.2.2</span> Example</h5>
<div id="24" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Structural parameters</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="fl">1</span>.</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>f0 <span class="op">=</span> <span class="fl">1</span>.</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>Î¾ <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiation of the Sdof object</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>sdof <span class="op">=</span> <span class="fu">Sdof</span>(m, f0, Î¾)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Haversine excitation signal</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>F0 <span class="op">=</span> <span class="fl">10</span>.</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>tstart <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>duration <span class="op">=</span> <span class="fl">2</span>.</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>haversine <span class="op">=</span> <span class="fu">HaverSine</span>(F0, tstart, duration)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> <span class="fl">0</span>.<span class="op">:</span><span class="fl">0.01</span><span class="op">:</span><span class="fl">10</span>.</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>F <span class="op">=</span> <span class="fu">excitation</span>(haversine, t)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiation of the problem</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>u0 <span class="op">=</span> [<span class="fl">1</span>, <span class="op">-</span><span class="fl">2</span>]</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>prob <span class="op">=</span> <span class="fu">SdofForcedTimeProblem</span>(sdof, F, u0, t, <span class="op">:</span>force)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Solve the problem</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>x_arb_filt <span class="op">=</span> <span class="fu">solve</span>(prob, method <span class="op">=</span> <span class="op">:</span>filt).u</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>x_arb_interp <span class="op">=</span> <span class="fu">solve</span>(prob, method <span class="op">=</span> <span class="op">:</span>interp).u</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>x_arb_conv <span class="op">=</span> <span class="fu">solve</span>(prob, method <span class="op">=</span> <span class="op">:</span>conv).u;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="26" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-14-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="additional-functions" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="additional-functions"><span class="header-section-number">1.3</span> Additional functions</h3>
<section id="impulse-response" class="level4" data-number="1.3.1">
<h4 data-number="1.3.1" class="anchored" data-anchor-id="impulse-response"><span class="header-section-number">1.3.1</span> Impulse response</h4>
<p>The impulse response of a sdof system is the response of the system when it is subjected to an impulse excitation. The impulse response is the solution of the following ordinary differential equation: <span class="math display">\[
\overset{..}{h}(t) + 2\xi\omega_0\overset{.}{h}(t) + \omega_0^2 h(t) = \frac{\delta(t)}{m}.
\]</span></p>
<p>It can be shown that the impulse response can be computed by solving the following problem: <span class="math display">\[
\begin{cases}
\overset{..}{h}(t) + 2\xi\omega_0\overset{.}{h}(t) + \omega_0^2 h(t) = 0 &amp; \forall t &gt; 0 \\
h(t) = 0 &amp; \text{at } t = 0 \\
\overset{.}{h}(t) = \displaystyle\frac{1}{m} &amp; \text{at } t = 0
\end{cases}.
\]</span></p>
<div class="api">
<p><strong>impulse_response</strong></p>
<hr>
<div id="28" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display" data-execution_count="1">
<div class="markdown"><pre><code>impulse_response(sdof, t)</code></pre>
<p>Compute the impulse response of a single degree of freedom (Sdof) system</p>
<p><strong>Inputs</strong></p>
<ul>
<li><p><code>sdof</code>: Sdof structure</p>
</li>
<li><p><code>t</code>: Time points at which to evaluate the response</p>
</li>
</ul>
<p><strong>Output</strong></p>
<ul>
<li><p><code>h</code>: Impulse response</p>
</li>
</ul>


</div>
</div>
</div>
</div>
<div id="30" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Structural parameters</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="fl">1</span>.</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>f0 <span class="op">=</span> <span class="fl">1</span>.</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>Î¾ <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> <span class="fl">0</span>.<span class="op">:</span><span class="fl">0.01</span><span class="op">:</span><span class="fl">10</span>.</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiation of the Sdof object</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>sdof <span class="op">=</span> <span class="fu">Sdof</span>(m, f0, Î¾)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>h <span class="op">=</span> <span class="fu">impulse_response</span>(sdof, t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="32" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-17-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="shock-response-spectrum" class="level4" data-number="1.3.2">
<h4 data-number="1.3.2" class="anchored" data-anchor-id="shock-response-spectrum"><span class="header-section-number">1.3.2</span> Shock response spectrum</h4>
<p>The shock response spectrum (SRS) is a graph of the peak acceleration response of a sdof system subjected to a base acceleration with respect to the frequency. The SRS is computed by solving the following problem: <span class="math display">\[
\ddot z(t) + 2\xi\omega_0\dot z(t) + \omega_0^2 z(t) = -\ddot x_b(t),
\]</span> where <span class="math inline">\(z(t) = x(t) - x_b(t)\)</span> is the relative displacement of the system with respect to the base.</p>
<p>To compute the SRS, the following steps are performed at a given frequency <span class="math inline">\(f\)</span>:</p>
<ol type="1">
<li><p>Instantiate a Sdof type</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>sdof <span class="op">=</span> <span class="fu">Sdof</span>(<span class="fl">1</span>., f, Î¾)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>Compute the time response of the relative displacement <span class="math inline">\(z(t)\)</span> due to a base acceleration for <span class="math inline">\(z(0) = 0\)</span> and <span class="math inline">\(\dot z(0) = 0\)</span>.</p></li>
<li><p>Compute the acceleration <span class="math inline">\(\ddot x(t)\)</span> of the system: <span class="math display">\[
x(t) = -2\xi\omega_0\dot z(t) - \omega_0^2 z(t)
\]</span></p></li>
<li><p>Extract the primary or secondary part of the acceleration (i.e.&nbsp;until or after the end of the excitation signal).</p></li>
<li><p>Compute either:</p>
<ul>
<li><p>The peak acceleration of the system such that: <span class="math display">\[
SRS(f) = \max\left(|\ddot x(t)|\right)
\]</span></p></li>
<li><p>The maximum positive acceleration of the system such that: <span class="math display">\[
SRS(f) = \max\left(\max(\ddot x(t), 0)\right)
\]</span></p></li>
<li><p>The maximum negative acceleration of the system such that: <span class="math display">\[
SRS(f) = \max\left(\max(-\ddot x(t), 0)\right)
\]</span></p></li>
</ul></li>
</ol>
<p>Several algorithms are available to compute the SRS:</p>
<ul>
<li><code>:Basic</code>: the SRS is computed by following the steps mentioned above. It is not the most efficient algorithm but it is the most versatile.</li>
<li><code>:RecursiveInt</code>: the SRS is computed using a recursive integration algorithm.</li>
<li><code>:RecursiveFilt</code>: the SRS is computed using a recursive filtering algorithm.</li>
<li><code>:Smallwood</code>: the SRS is computed using the Smallwood algorithm.</li>
</ul>
<p>For the last three algorithms, more details and references can be found <a href="https://fr.mathworks.com/help/signal/ug/practical-introduction-to-shock-waveform-and-shock-response-spectrum.html">Mathworks - Introduction to SRS</a></p>
<div class="api">
<p><strong>srs</strong></p>
<hr>
<div id="34" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display" data-execution_count="1">
<div class="markdown"><pre><code>srs(base_acc::ArbitraryExc, freq, t, Î¾ = 0.05,
    type = (instance = :primary, amplitude = :abs), alg = :Smallwood)</code></pre>
<p>Compute the Shock Response Spectrum (SRS)</p>
<p><strong>Inputs</strong></p>
<ul>
<li><p><code>base_acc::ArbitraryExc</code>: Base acceleration type - see <code>excitation</code> function for detatils</p>
</li>
<li><p><code>freq</code>: Vector of frequencies [Hz]</p>
</li>
<li><p><code>t</code>: Time points at which to evaluate the response</p>
</li>
<li><p><code>Î¾</code>: Damping ratio (default = 0.05)</p>
</li>
<li><p><code>type</code>: Type of SRS</p>
<ul>
<li><p><code>instance</code>: Instance of the SRS</p>
<ul>
<li><p><code>:primary</code>: Primary instance (default)</p>
</li>
<li><p><code>:secondary</code>: Secondary instance</p>
</li>
</ul>
</li>
<li><p><code>amplitude</code>: Amplitude used of the computing SRS</p>
<ul>
<li><p><code>:abs</code>: Maximum absolute amplitude (default)</p>
</li>
<li><p><code>:pos</code>: Maximum positive amplitude</p>
</li>
<li><p><code>:neg</code>: Maximum negative amplitude</p>
</li>
</ul>
</li>
</ul>
</li>
<li><p><code>alg</code>: Algorithm to compute the SRS</p>
<ul>
<li><p><code>:Basic</code>: Basic algorithm</p>
</li>
<li><p><code>:RecursiveInt</code>: Recursive integration algorithm</p>
</li>
<li><p><code>:RecursiveFilt</code>: Recursive filtering algorithm</p>
</li>
<li><p><code>:Smallwood</code>: Smallwood algorithm (default)</p>
</li>
</ul>
</li>
</ul>
<p><strong>Output</strong></p>
<ul>
<li><p><code>srs</code>: Vector of the SRS values</p>
</li>
</ul>
<p><em>Note</em></p>
<ul>
<li><p>Primary instance - response of the system during the application of the base acceleration</p>
</li>
<li><p>Secondary instance - response of the system after the application of the base acceleration</p>
</li>
</ul>


</div>
</div>
</div>
</div>
<div id="36" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Definition of the base acceleration</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> <span class="fl">0</span>.<span class="op">:</span><span class="fl">1e-5</span><span class="op">:</span><span class="fl">0.5</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>base_acc <span class="op">=</span> <span class="fu">HalfSine</span>(<span class="fl">10</span>., <span class="fl">0</span>., <span class="fl">1e-3</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the SRS</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="fl">50</span>.<span class="op">:</span><span class="fl">25</span><span class="op">:</span><span class="fl">1e3</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>srs_basic <span class="op">=</span> <span class="fu">srs</span>(base_acc, f, t)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>srs_rec_int <span class="op">=</span> <span class="fu">srs</span>(base_acc, f, t, alg <span class="op">=</span> <span class="op">:</span>RecursiveInt)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>srs_rec_filt <span class="op">=</span> <span class="fu">srs</span>(base_acc, f, t, alg <span class="op">=</span> <span class="op">:</span>RecursiveFilt)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>srs_smallwood <span class="op">=</span> <span class="fu">srs</span>(base_acc, f, t, alg <span class="op">=</span> <span class="op">:</span>Smallwood)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="38" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-20-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="frequency-domain-solvers" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="frequency-domain-solvers"><span class="header-section-number">2</span> Frequency domain solvers</h2>
<p>The package provides solvers for computing the Frequency Response Function (FRF) and the response spectrum of a sdof system.</p>
<section id="frequency-response-function" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="frequency-response-function"><span class="header-section-number">2.1</span> Frequency Response Function</h3>
<p>The Frequency Response Function (FRF) of a sdof system is the ratio of the steady-state response <span class="math inline">\(X(\omega)\)</span> of the system to an external excitation <span class="math inline">\(F(\omega)\)</span> or an external base motion <span class="math inline">\(X_b(\omega)\)</span>. The FRF is computed from the following equation: <span class="math display">\[
H(\omega) = \begin{cases}
\displaystyle\frac{1}{m(\omega_0^2 - \omega^2 + 2j\xi\omega\omega_0)} &amp; \text{for a force excitation} \\
\displaystyle\frac{\omega_0^2 + 2j\xi\omega\omega_0}{\omega_0^2 - \omega^2 + 2j\xi\omega\omega_0} &amp; \text{for a base excitation}
\end{cases},
\]</span> where <span class="math inline">\(j\)</span> is the imaginary unit.</p>
<section id="api-3" class="level4" data-number="2.1.1">
<h4 data-number="2.1.1" class="anchored" data-anchor-id="api-3"><span class="header-section-number">2.1.1</span> API</h4>
<p><strong>Data type</strong></p>
<div class="api">
<p><strong>SdofFRFProblem</strong></p>
<hr>
<div id="40" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display" data-execution_count="1">
<div class="markdown"><pre><code>SdofFRFProblem(sdof, freq, type_exc, type_resp)</code></pre>
<p>Structure containing the data for computing the FRF a sdof system</p>
<p><strong>Fields</strong></p>
<ul>
<li><p><code>sdof::Sdof</code>: Sdof structure</p>
</li>
<li><p><code>freq::AbstractRange</code>: Vector of frequencies [Hz]</p>
</li>
<li><p><code>type_exc::Symbol</code>: Type of excitation</p>
<ul>
<li><p><code>:force</code>: External force (default)</p>
</li>
<li><p><code>:base</code>: Base motion</p>
</li>
</ul>
</li>
<li><p><code>type_resp::Symbol</code>: Type of response</p>
<ul>
<li><p><code>:dis</code>: Admittance (default)</p>
</li>
<li><p><code>:vel</code>: Mobility</p>
</li>
<li><p><code>:acc</code>: Accelerance</p>
</li>
</ul>
</li>
</ul>


</div>
</div>
</div>
</div>
<p><strong>Related function</strong></p>
<div class="api">
<p><strong>solve</strong></p>
<hr>
<div id="42" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display" data-execution_count="1">
<div class="markdown"><pre><code>solve(prob::SdofFRFProblem)</code></pre>
<p>Compute the FRF of a single degree of freedom (Sdof) system</p>
<p><strong>Inputs</strong></p>
<ul>
<li><p><code>prob</code>: Structure containing the parameters of the Sdof FRF problem</p>
</li>
</ul>
<p><strong>Output</strong></p>
<ul>
<li><p><code>sol</code>: Solution of the FRF problem</p>
<ul>
<li><p><code>u</code>: FRF of the system</p>
</li>
</ul>
</li>
</ul>


</div>
</div>
</div>
</div>
</section>
<section id="example-3" class="level4" data-number="2.1.2">
<h4 data-number="2.1.2" class="anchored" data-anchor-id="example-3"><span class="header-section-number">2.1.2</span> Example</h4>
<div id="44" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Structural parameters</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="fl">1</span>.</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>f0 <span class="op">=</span> <span class="fl">10</span>.</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>Î¾ <span class="op">=</span> <span class="fl">0.01</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiation of the Sdof object</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>sdof <span class="op">=</span> <span class="fu">Sdof</span>(m, f0, Î¾)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Definition of the frequency range</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="fl">1</span>.<span class="op">:</span><span class="fl">0.1</span><span class="op">:</span><span class="fl">30</span>.</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiation of the problem - Force excitation</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>prob <span class="op">=</span> <span class="fu">SdofFRFProblem</span>(sdof, f)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Solve the problem</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>H <span class="op">=</span> <span class="fu">solve</span>(prob).u</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="46" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-24-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="response-spectrum" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="response-spectrum"><span class="header-section-number">2.2</span> Response spectrum</h3>
<p>The response spectrum of a sdof system is the frequency response of the system to an external force <span class="math inline">\(F(\omega)\)</span> or a base motion <span class="math inline">\(X_b(\omega)\)</span> with respect to the frequency. The response spectrum <span class="math inline">\(Y(\omega)\)</span> is computed from the following equation: <span class="math display">\[
Y(\omega) = \begin{cases}
\displaystyle\frac{F(\omega)}{m(\omega_0^2 - \omega^2 + 2j\xi\omega\omega_0)} &amp; \text{for a force excitation} \\
\displaystyle\frac{(\omega_0^2 + 2j\xi\omega\omega_0) X_b(\omega)}{\omega_0^2 - \omega^2 + 2j\xi\omega\omega_0} &amp; \text{for a base excitation}
\end{cases}.
\]</span></p>
<section id="api-4" class="level4" data-number="2.2.1">
<h4 data-number="2.2.1" class="anchored" data-anchor-id="api-4"><span class="header-section-number">2.2.1</span> API</h4>
<p><strong>Data type</strong></p>
<div class="api">
<p><strong>SdofFRFProblem</strong></p>
<hr>
<div id="48" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display" data-execution_count="1">
<div class="markdown"><pre><code>SdofFrequencyProblem(sdof, F, type_exc, type_resp)</code></pre>
<p>Structure containing the data for computing the frequency response of a sdof system</p>
<p><strong>Fields</strong></p>
<ul>
<li><p><code>sdof::Sdof</code>: Sdof structure</p>
</li>
<li><p><code>F::AbstractVector</code>: Vector of the force excitation [N] or base motion [m]</p>
</li>
<li><p><code>freq::AbstractRange</code>: Vector of frequencies [Hz]</p>
</li>
<li><p><code>type_exc::Symbol</code>: Type of excitation</p>
<ul>
<li><p><code>:force</code>: External force (default)</p>
</li>
<li><p><code>:base</code>: Base motion</p>
</li>
</ul>
</li>
<li><p><code>type_resp::Symbol</code>: Type of response</p>
<ul>
<li><p><code>:dis</code>: Displacement spectrum(default)</p>
</li>
<li><p><code>:vel</code>: Velocity spectrum</p>
</li>
<li><p><code>:acc</code>: Acceleration spectrum</p>
</li>
</ul>
</li>
</ul>


</div>
</div>
</div>
</div>
<p><strong>Related function</strong></p>
<div class="api">
<p><strong>solve</strong></p>
<hr>
<div id="50" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display" data-execution_count="1">
<div class="markdown"><pre><code>solve(prob::SdofFRFProblem)</code></pre>
<p>Compute the FRF of a single degree of freedom (Sdof) system</p>
<p><strong>Inputs</strong></p>
<ul>
<li><p><code>prob</code>: Structure containing the parameters of the Sdof FRF problem</p>
</li>
</ul>
<p><strong>Output</strong></p>
<ul>
<li><p><code>sol</code>: Solution of the FRF problem</p>
<ul>
<li><p><code>u</code>: FRF of the system</p>
</li>
</ul>
</li>
</ul>


</div>
</div>
</div>
</div>
</section>
<section id="example-4" class="level4" data-number="2.2.2">
<h4 data-number="2.2.2" class="anchored" data-anchor-id="example-4"><span class="header-section-number">2.2.2</span> Example</h4>
<div id="52" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Structural parameters</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="fl">1</span>.</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>f0 <span class="op">=</span> <span class="fl">10</span>.</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>Î¾ <span class="op">=</span> <span class="fl">0.01</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiation of the Sdof object</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>sdof <span class="op">=</span> <span class="fu">Sdof</span>(m, f0, Î¾)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Definition of the frequency range</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="fl">1</span>.<span class="op">:</span><span class="fl">0.1</span><span class="op">:</span><span class="fl">30</span>.</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiation of the problem - Force excitation</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>F <span class="op">=</span> <span class="fu">fill</span>(<span class="fl">10</span>., <span class="fu">length</span>(f))</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>prob <span class="op">=</span> <span class="fu">SdofFrequencyProblem</span>(sdof, F, f)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Solve the problem</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> <span class="fu">solve</span>(prob).u</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="54" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-28-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/maucejo\.github\.io\/StructuralVibration\.jl\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
  </div>
  <div class="nav-page nav-page-next">
      <a href="../solvers/modal_time_solvers.html" class="pagination-link" aria-label="Modal time solvers">
        <span class="nav-page-text">Modal time solvers</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>2025 Mathieu Aucejo âˆ™ Powered by <a href="https://quarto.org"><img src="..\assets/logo/quarto.png" class="img-fluid" style="width:4mm"></a> and <a href="https://julialang.org"><img src="..\assets/logo/julia.svg" class="img-fluid" style="width:4mm"></a></p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>